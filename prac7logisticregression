loan<-read.csv(file.choose(),header=T,sep=",")
head(loan)
summary(loan)
str(loan)
loan$AGE<-as.factor(loan$AGE)
str(loan)
names(loan)
"creating model"
model1<-glm(DEFAULTER~.,family = binomial,data = loan)
summary(model1)
"global testing for the acceptance of the model"
null<-glm(DEFAULTER~1,family = binomial,data=loan)
anova(null,model1,test = "Chisq")
"predicting the probilities"
loan$predprob<-round(fitted(model1),2)
head(loan)
"classification and misclassification analysis "
library(gmodels)
table(loan$DEFAULTER,fitted(model1)>0.5)
sens<-95/(88+95)*100
sens
spc<-478/(478+39)*100
spc

"check the trade off between sensivity and specificity using different cut off values"
table(loan$DEFAULTER,fitted(model1)>0.1)
table(loan$DEFAULTER,fitted(model1)>0.2)
table(loan$DEFAULTER,fitted(model1)>0.3)
table(loan$DEFAULTER,fitted(model1)>0.4)
table(loan$DEFAULTER,fitted(model1)>0.5)

"goodness of fit using receiver Operational Curve "
pred<-predict(model1,loan,type="response")
install.packages("ROCR")
library(ROCR)
rocrpred<-prediction(pred,loan$DEFAULTER)
rocrperf<-performance(rocrpred,"tpr","fpr")
"to check proper cut off point"
plot(rocrperf,colorize=TRUE,print.cutoffs.at=seq(0.1,by=0.1))

"to check coeficients"
coef(model1)
exp(coef(model1))

"as credit to debit ratio of person incerases by 1 unit ,odds of the event increses by 77%"
"model validation same as linear regression"
"variable selection same as linear regresiion"



index.csv
SN	AGE	EMPLOY	ADDRESS	DEBTINC	CREDDEBT	OTHDEBT	DEFAULTER
1	3	17	12	9.3	11.36	5.01	1
2	1	10	6	17.3	1.36	4	0
3	2	15	14	5.5	0.86	2.17	0
4	3	15	14	2.9	2.66	0.82	0
5	1	2	0	17.3	1.79	3.06	1
6	3	5	5	10.2	0.39	2.16	0
7	2	20	9	30.6	3.83	16.67	0
8	3	12	11	3.6	0.13	1.24	0
9	1	3	4	24.4	1.36	3.28	1
10	2	0	13	19.7	2.78	2.15	0
11	1	0	1	1.7	0.18	0.09	0
12	1	4	0	5.2	0.25	0.94	0
13	3	24	14	10	3.93	2.47	0
14	2	6	9	16.3	1.72	3.01	0
15	3	22	15	9.1	3.7	5.4	0
16	2	9	6	8.6	0.82	3.4	1
17	2	13	6	16.4	2.92	3.81	1
18	3	23	19	7.6	1.18	4.29	0
19	2	6	9	5.7	0.56	2.91	0
20	3	0	21	1.7	0.1	0.34	0
21	2	22	3	3.2	1.15	0.51	0
22	3	17	21	5.6	0.59	1.82	0
23	1	3	6	10	0.43	2.17	0
24	1	8	6	9.8	0.4	2.24	0
25	1	1	2	18	0.24	2.64	1
26	1	0	2	17.6	2.14	3.49	0
27	3	9	26	6.7	0.71	3.92	0
28	3	25	21	16.7	0.95	9.74	0
29	2	12	8	18.4	3.08	7.59	0
30	1	2	1	14.2	0.2	5.05	0
31	3	3	15	2.1	0.11	0.32	0
32	1	1	10	10.5	1.14	1.17	0
33	1	2	7	6	0.72	0.84	0
34	1	8	4	14.4	1.02	2.87	0
35	1	8	1	2.9	0.08	0.94	0
36	1	6	7	26	6.05	5.65	0
37	1	10	4	16.1	1.41	2.13	0
38	2	12	1	14.4	3.2	4.58	0
39	1	1	8	17.1	1.34	2.77	1
40	3	23	5	4.2	0.56	1.54	0
41	1	7	2	6.6	0.34	1.71	0
42	2	17	3	8	1.81	2.91	0
43	3	7	23	4.6	0.94	0.94	0
44	2	19	5	13.1	1.93	4.36	0
45	1	0	0	7.5	0.3	0.75	1
46	1	0	1	6.8	0.15	0.94	0
47	2	13	15	4.5	0.43	1.14	0
48	3	4	2	10.4	0.12	2.58	0
49	1	0	2	11.4	0.78	1.62	1
50	2	18	2	7.4	0.21	2.9	0
51	2	2	11	12.6	0.57	2.58	1
52	3	1	12	14	0.81	1.99	0
53	3	16	18	12.9	3.03	3.68	1
54	2	3	18	3.7	0.31	0.61	0
55	2	3	2	9.5	0.55	2.11	0
56	2	1	3	15.1	1.8	1.82	1
57	2	9	1	5	0.4	1.3	0
58	2	16	13	2.4	1.06	0.59	0
59	2	18	6	2.5	1.49	1.02	0
60	3	10	20	12.2	2.48	7.28	0
61	2	9	10	2.4	0.05	0.62	0
62	1	13	1	7.4	1.46	1.65	1
63	2	4	0	12.4	0.87	1.98	0
64	2	4	9	7	2.16	1.69	0
65	1	5	7	7.8	1.02	1.16	0
66	2	11	6	23.3	7.76	9.72	1
67	1	2	3	6.4	0.19	1.29	1
68	2	19	8	9.1	2.52	1.67	0
69	1	8	3	8.2	1.49	1.05	1
70	1	1	2	18.6	0.57	3.15	1
71	2	3	8	23.1	1.4	3.45	0
72	1	5	9	23.8	3.1	4.99	0
73	3	26	21	12.8	4.58	8.22	0
74	3	1	5	10.6	1.52	1.24	0
75	3	13	10	1.7	0.07	0.68	0
76	3	13	25	23.8	3.74	8.4	0
77	1	2	1	0.6	0.03	0.1	0
78	1	1	9	6.7	0.16	0.98	0
79	2	14	2	2.6	0.2	0.76	0
80	2	15	10	3.2	0.69	0.56	0
81	1	4	3	10.5	2.47	0.36	1
82	2	11	12	17	2.74	4.91	0
83	2	7	3	19.6	2.7	3.58	0
84	2	4	16	11	1.84	1.35	0
85	1	4	3	5.4	0.32	0.76	0
86	2	10	15	18.8	2.01	6.45	0
87	1	5	4	12.4	3.49	0.97	1
88	2	5	17	24.6	1.41	5.73	0
89	2	12	12	2.9	0.12	0.7	0
90	1	0	1	27.7	2.04	2.67	1
91	2	3	10	6.2	0.05	1.37	0
92	1	1	6	11.4	0.37	1.34	1
93	2	5	5	10.6	1.5	4.22	0
94	2	0	6	5.8	0.3	0.75	1
95	3	2	0	26.3	1.96	1.98	1
96	2	17	6	4.4	0.73	1.65	0
97	3	13	0	3.3	1.32	1.39	0
98	3	14	8	7.3	0.93	2.87	0
99	1	4	9	6.3	0.68	0.52	0
100	2	4	6	9.3	1.33	1.55	1
101	2	22	9	2.6	0.99	1.95	0
102	2	6	9	8.3	0.03	2.13	0
103	2	8	7	5.8	0.78	0.79	0
104	3	21	11	3.1	1.37	2.39	0
105	3	22	17	23.6	9.88	7.82	0
106	2	8	17	3.6	0.53	0.47	0
107	3	9	18	11.2	2.02	3.58	1
108	1	4	7	13.5	1.3	2.21	0
109	2	12	13	7.9	1.72	3.02	0
110	2	9	13	10.1	1.12	3.43	0
111	3	2	5	4.9	0.46	1.45	0
112	2	6	0	8.9	0.27	3.38	0
113	1	0	2	7.7	0.83	1.01	0
114	3	12	11	21.4	2.41	8.5	0
115	3	16	25	8.6	1.87	3.64	0
116	1	4	6	5.2	0.55	1.16	0
117	2	9	9	6.2	2.11	1.92	0
118	2	15	16	3.4	1.03	1.45	0
119	2	0	4	12.8	1.09	2.37	1
120	1	1	0	6.7	0.47	0.87	1
121	3	12	19	9.5	1.34	2.17	0
122	1	3	0	8.4	0.28	1.32	1
123	2	6	3	35.3	1.98	7.55	1
124	2	2	4	12.7	1.09	1.7	1
125	1	5	9	2.8	0.14	0.48	0
126	3	7	11	4.4	0.69	1.2	0
127	2	7	2	13	1.02	7.82	1
128	1	9	3	1.4	0.13	0.38	0
129	1	5	1	9	0.37	1.88	0
130	3	19	2	5.8	1.51	2.44	0
131	1	1	7	2.9	0.31	0.47	0
132	2	5	10	12.9	0.98	1.34	0
133	3	18	19	17.4	0.55	5.54	0
134	2	17	20	13.7	2.45	5.77	0
135	1	7	2	6.3	0.52	0.8	0
136	1	6	7	2.2	0.45	0.8	0
137	1	1	0	12.4	0.29	2.57	0
138	2	13	2	5.9	0.96	0.69	0
139	1	8	10	6.7	0.47	1.14	0
140	1	4	3	6.6	1.16	1.28	1
141	1	0	2	16	1.01	1.55	1
142	1	9	6	17.8	2.85	5.16	1
143	3	16	22	4.4	1.28	4.66	0
144	2	11	8	9.1	0.14	2.13	0
145	3	16	17	5.4	0.45	3.22	0
146	3	5	3	3.4	0.36	1.04	0
147	1	1	3	12.4	0.38	2.85	0
148	1	2	8	10	1.77	0.73	0
149	1	11	1	8.4	0.68	2.09	0
150	2	8	4	8	1.72	1.8	0
151	3	15	14	18.1	1.55	7.68	0
152	3	13	23	6.1	2.15	2.48	1
153	2	4	10	16.3	1.33	2.42	0
154	1	8	6	7.2	0.61	1.55	0
155	1	3	5	13.2	1.63	2.72	0
156	2	13	3	19.2	2.8	4.69	0
157	2	12	11	11.3	2.1	1.51	0
158	3	9	2	14.8	1.56	2.59	1
159	2	9	4	13.8	1.35	2.65	1
160	2	9	5	4.5	0.31	0.86	0
161	1	4	0	8.9	1.42	0.89	0
162	1	5	9	8.7	0.77	3.05	0
163	2	2	1	6.8	0.28	1.49	1
164	2	8	6	4.1	0.33	0.74	0
165	2	1	8	12.5	0.59	2.41	1
166	2	13	11	18.9	6.23	13.05	1
167	1	4	2	15.6	1.64	2.11	1
168	2	4	9	6.5	1.18	1.29	0
169	3	14	3	1.7	0.35	0.39	0
170	2	16	9	4	1.73	1.43	0
171	1	7	9	9.7	0.55	1.58	0
172	2	4	10	11.3	0.29	2.87	0
173	2	1	0	4.8	0.31	0.65	1
174	2	14	7	8.8	3.75	2.67	0
175	2	6	14	7.5	0.57	1.01	0
176	1	6	0	10.3	0.72	1.55	0
177	1	1	1	17.3	0.16	2.96	0
178	1	7	2	7	0.36	2.02	0
179	2	13	5	8.9	0.6	1.53	0
180	2	2	14	22.9	2.12	5.89	1
181	2	12	10	5	0.56	1.74	0
182	2	8	19	5.6	0.88	2.31	0
183	3	16	21	3	0.91	1.49	0
184	1	10	6	6.5	0.85	1.36	0
185	1	0	7	24.2	1.42	5.59	0
186	2	13	9	8	0.97	1.19	0
187	2	14	21	15	2.79	3.66	1
188	1	11	8	16.9	4.64	4.83	0
189	2	1	4	9.3	0.43	1.05	0
190	3	19	2	15.6	4.4	7.76	0
191	1	4	3	13.2	1.09	1.82	1
192	1	1	8	11	0.75	1.12	0
193	2	10	0	11.2	0.82	2.32	1
194	2	1	6	2.5	0.28	0.25	1
195	2	13	2	7.2	0.18	2.7	0
196	1	4	0	4.2	0.5	0.89	0
197	1	1	0	5.9	0.24	0.82	1
198	2	9	10	4.3	0.38	0.83	0
199	3	8	27	6.9	0.4	2.84	0
200	2	6	6	23.1	3.34	4.05	1
201	1	3	7	4.1	0.26	0.52	0
202	3	8	10	6.1	0.28	5.08	1
203	3	3	23	9.8	0.97	3.44	0
204	2	0	17	9.7	0.33	2.58	0
205	1	7	1	5.5	0.57	2.89	0
206	2	17	11	6	2.56	4.4	0
207	2	7	6	6	0.54	1.02	0
208	1	6	6	1	0.14	0.16	0
209	2	14	11	7.2	1.78	4.05	0
210	1	6	0	1.9	0.09	0.58	0
211	2	16	6	12.1	1.61	12.42	0
212	3	5	3	9	1.97	2.35	1
213	1	1	10	4.5	0.28	1.07	0
214	2	5	3	5.4	0.58	1.42	1
215	2	16	3	10.4	3.95	3.85	0
216	2	12	8	6.7	1.3	1.85	0
217	3	14	25	10.2	1.35	2.22	0
218	3	21	22	12.2	3.24	14.45	0
219	1	7	8	4	0.45	0.75	1
220	1	0	6	8	1.62	3.98	1
221	1	11	6	2.4	0.11	0.47	0
222	3	0	27	10.8	0.85	1.2	0
223	3	17	26	12	3.38	10.18	0
224	1	5	6	19.9	3.18	10.75	1
225	3	9	5	20.4	4.04	8.2	1
226	1	5	2	7.9	0.3	1.04	0
227	1	10	8	18.1	3.7	4.26	0
228	2	5	6	1.9	0.88	0.54	0
229	1	0	3	5.6	0.21	0.91	0
230	1	7	3	14.4	0.85	2.32	0
231	3	9	10	15.3	1.61	7.57	0
232	3	3	11	8	0.56	2.64	1
233	2	8	16	0.6	0.03	0.2	0
234	2	5	1	2.8	0.1	0.82	0
235	1	11	9	0.9	0.07	0.17	0
236	1	7	0	6.5	0.53	0.64	0
237	1	4	3	9.5	0.23	2.43	0
238	2	2	11	9.1	0.12	1.25	1
239	2	11	4	3.5	0.63	1.99	0
240	2	6	19	19.9	2.54	5.82	1
241	1	4	4	18.3	0.49	3.35	0
242	1	10	11	9.5	2.06	1.65	0
243	2	7	10	4.3	0.43	0.94	0
244	3	21	20	14.4	9.6	7.39	0
245	1	3	4	13.3	1.6	3.05	0
246	2	12	4	23.7	2.06	5.29	0
247	2	15	16	1.8	0.14	0.56	0
248	2	5	3	14.1	1.18	2.35	0
249	2	15	11	18.5	1.21	6.19	0
250	2	10	16	13.3	4.87	8.16	0
251	3	22	17	11.1	3.32	12.66	0
252	2	13	3	21.3	2.71	8.36	1
253	2	13	3	1.9	1.42	0.58	0
254	2	1	1	7.9	0.37	1.29	0
255	2	5	13	9	0.45	1.44	0
256	3	19	1	7.8	2.25	5.23	0
257	2	18	19	4.5	0.61	1.37	0
258	2	2	14	13.2	1.14	4.01	0
259	3	16	25	4.4	2.6	1	0
260	2	10	2	9.5	0.57	2.56	0
261	3	15	1	24.5	2.21	5.14	0
262	2	8	6	5.4	2.16	2.06	0
263	1	8	7	11.9	0.4	1.74	0
264	3	9	11	19.2	0.8	3.81	1
265	2	9	6	5	0.23	1.52	0
266	2	7	0	6.4	0.63	0.78	0
267	2	0	1	7.2	0.19	1.32	0
268	2	9	7	14.6	3.11	5.5	1
269	1	2	9	15.2	0.87	1.56	0
270	2	19	16	3.7	0.92	0.75	0
271	3	22	23	7.6	4.14	4.98	0
272	1	4	1	1.2	0.08	0.11	0
273	1	6	4	10.4	0.93	1.77	0
274	2	16	10	21	0.69	7.29	0
275	1	6	7	7.2	0.77	1.96	0
276	1	1	0	10.3	0.38	1.68	1
277	1	2	6	13.6	1.58	1.69	1
278	2	14	0	2.4	0.27	0.59	0
279	1	0	11	3.7	0.45	0.18	1
280	2	13	1	8.9	1.9	1.48	0
281	2	11	6	4.8	0.35	1	1
282	2	15	2	24.7	4.37	5.26	1
283	2	8	3	12.6	0.13	5.03	0
284	1	1	7	10.4	0.57	2.03	0
285	1	9	0	13.9	1.07	2.4	0
